{"ast":null,"code":"import React,{useState,useEffect}from'react';import apiService from'../api/apiService';import'../App.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ClockInOutGPS=()=>{const[todaysAttendance,setTodaysAttendance]=useState(null);const[isClockedIn,setIsClockedIn]=useState(false);const[error,setError]=useState(null);const[loading,setLoading]=useState(true);const fetchTodaysAttendance=async()=>{try{const{data}=await apiService.get('/attendance/today');setTodaysAttendance(data);setIsClockedIn(data&&!data.clock_out_time);}catch(err){console.error(\"Failed to fetch today's attendance\",err);setError(\"Could not retrieve today's attendance status.\");}finally{setLoading(false);}};useEffect(()=>{fetchTodaysAttendance();},[]);const handleClockInOut=async()=>{setLoading(true);setError(null);try{const position=await new Promise((resolve,reject)=>{navigator.geolocation.getCurrentPosition(resolve,reject);});const{latitude,longitude}=position.coords;const endpoint=isClockedIn?'/attendance/clock-out':'/attendance/clock-in';const response=await apiService.post(endpoint,{latitude,longitude});setTodaysAttendance(response.data.attendance);setIsClockedIn(!isClockedIn);alert(`Successfully clocked ${isClockedIn?'out':'in'}!`);}catch(err){var _err$response,_err$response$data;const errorMessage=((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||`Failed to clock ${isClockedIn?'out':'in'}.`;setError(errorMessage);console.error('Clock-in/out failed:',err);}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"dashboard-header\",children:\"GPS Clock In / Out\"}),/*#__PURE__*/_jsx(\"div\",{className:\"section clock-in-out\",children:loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading status...\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"clock-status\",children:/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Current Status:\"}),\" \",isClockedIn?`Clocked In at ${new Date(todaysAttendance.clock_in_time).toLocaleTimeString()}`:'Clocked Out']})}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:error}),/*#__PURE__*/_jsx(\"div\",{className:\"clock-buttons\",children:/*#__PURE__*/_jsx(\"button\",{onClick:handleClockInOut,className:`clock-btn ${isClockedIn?'out':'in'}`,disabled:loading,children:isClockedIn?'Clock Out':'Clock In'})})]})})]});};export default ClockInOutGPS;","map":{"version":3,"names":["React","useState","useEffect","apiService","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ClockInOutGPS","todaysAttendance","setTodaysAttendance","isClockedIn","setIsClockedIn","error","setError","loading","setLoading","fetchTodaysAttendance","data","get","clock_out_time","err","console","handleClockInOut","position","Promise","resolve","reject","navigator","geolocation","getCurrentPosition","latitude","longitude","coords","endpoint","response","post","attendance","alert","_err$response","_err$response$data","errorMessage","message","className","children","Date","clock_in_time","toLocaleTimeString","onClick","disabled"],"sources":["C:/Users/Tshepiso Selemela/OneDrive/Documents/Tymstamp/FrontEnd/my-app/src/pages/ClockInOutGPS.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport apiService from '../api/apiService';\r\nimport '../App.css';\r\n\r\nconst ClockInOutGPS = () => {\r\n  const [todaysAttendance, setTodaysAttendance] = useState(null);\r\n  const [isClockedIn, setIsClockedIn] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const fetchTodaysAttendance = async () => {\r\n    try {\r\n      const { data } = await apiService.get('/attendance/today');\r\n      setTodaysAttendance(data);\r\n      setIsClockedIn(data && !data.clock_out_time);\r\n    } catch (err) {\r\n      console.error(\"Failed to fetch today's attendance\", err);\r\n      setError(\"Could not retrieve today's attendance status.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchTodaysAttendance();\r\n  }, []);\r\n\r\n  const handleClockInOut = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const position = await new Promise((resolve, reject) => {\r\n        navigator.geolocation.getCurrentPosition(resolve, reject);\r\n      });\r\n      const { latitude, longitude } = position.coords;\r\n\r\n      const endpoint = isClockedIn ? '/attendance/clock-out' : '/attendance/clock-in';\r\n      const response = await apiService.post(endpoint, { latitude, longitude });\r\n\r\n      setTodaysAttendance(response.data.attendance);\r\n      setIsClockedIn(!isClockedIn);\r\n      alert(`Successfully clocked ${isClockedIn ? 'out' : 'in'}!`);\r\n\r\n    } catch (err) {\r\n      const errorMessage = err.response?.data?.message || `Failed to clock ${isClockedIn ? 'out' : 'in'}.`;\r\n      setError(errorMessage);\r\n      console.error('Clock-in/out failed:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"dashboard\">\r\n      <h2 className=\"dashboard-header\">GPS Clock In / Out</h2>\r\n      <div className=\"section clock-in-out\">\r\n        {loading ? (\r\n          <p>Loading status...</p>\r\n        ) : (\r\n          <>\r\n            <div className=\"clock-status\">\r\n              <p>\r\n                <strong>Current Status:</strong> {isClockedIn ? \r\n                `Clocked In at ${new Date(todaysAttendance.clock_in_time).toLocaleTimeString()}` : \r\n                'Clocked Out'}\r\n              </p>\r\n            </div>\r\n            {error && <div className=\"error\">{error}</div>}\r\n            <div className=\"clock-buttons\">\r\n              <button onClick={handleClockInOut} className={`clock-btn ${isClockedIn ? 'out' : 'in'}`} disabled={loading}>\r\n                {isClockedIn ? 'Clock Out' : 'Clock In'}\r\n              </button>\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ClockInOutGPS;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}