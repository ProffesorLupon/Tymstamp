{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Tshepiso Selemela\\\\OneDrive\\\\Documents\\\\Tymstamp\\\\FrontEnd\\\\my-app\\\\src\\\\components\\\\CameraCaptureModal.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect, useState } from 'react';\nimport '../styles/FacialRecognition.css'; // Reusing styles for a consistent look\n\n/**\r\n * A generic modal component for capturing a photo using the device's camera.\r\n * @param {object} props\r\n * @param {boolean} props.isOpen - Controls if the modal is visible.\r\n * @param {function} props.onClose - Function to call when the modal is closed.\r\n * @param {function} props.onCapture - Function to call with the captured image data (base64).\r\n */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CameraCaptureModal = ({\n  isOpen,\n  onClose,\n  onCapture\n}) => {\n  _s();\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const [stream, setStream] = useState(null);\n  const [error, setError] = useState('');\n\n  // Effect to start and stop the camera stream based on modal visibility.\n  useEffect(() => {\n    if (isOpen) {\n      startCamera();\n    } else {\n      stopCamera();\n    }\n\n    // Cleanup function to ensure the camera is turned off when the component unmounts.\n    return () => {\n      stopCamera();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isOpen]);\n\n  /**\r\n   * Requests camera access and starts the video stream.\r\n   */\n  const startCamera = async () => {\n    setError('');\n    // Ensure we can access the user's camera.\n    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n      setError('Camera is not supported by this browser.');\n      return;\n    }\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: true\n      });\n      setStream(stream);\n      if (videoRef.current) {\n        videoRef.current.srcObject = stream;\n      }\n    } catch (err) {\n      console.error(\"Error accessing camera:\", err);\n      setError('Could not access the camera. Please ensure you have given permission in your browser settings.');\n    }\n  };\n\n  /**\r\n   * Stops all tracks of the active camera stream.\r\n   */\n  const stopCamera = () => {\n    if (stream) {\n      stream.getTracks().forEach(track => track.stop());\n      setStream(null);\n    }\n  };\n\n  /**\r\n   * Captures a still frame from the video feed and passes it to the parent.\r\n   */\n  const handleCapture = () => {\n    if (videoRef.current && canvasRef.current) {\n      const video = videoRef.current;\n      const canvas = canvasRef.current;\n      canvas.width = video.videoWidth;\n      canvas.height = video.videoHeight;\n      const context = canvas.getContext('2d');\n      // Flip the image horizontally to match the mirrored video feed\n      context.translate(video.videoWidth, 0);\n      context.scale(-1, 1);\n      context.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);\n\n      // Convert the canvas image to a base64 data URL (JPEG format).\n      const imageDataUrl = canvas.toDataURL('image/jpeg');\n      onCapture(imageDataUrl);\n      onClose(); // Close the modal after capture\n    }\n  };\n  if (!isOpen) {\n    return null;\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"facial-rec-backdrop\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"facial-rec-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Capture Employee Photo\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Please ask the employee to face the camera.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"camera-container\",\n        children: [error ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"camera-error\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"video\", {\n          ref: videoRef,\n          autoPlay: true,\n          playsInline: true,\n          className: \"camera-feed\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: canvasRef,\n          style: {\n            display: 'none'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"facial-rec-actions\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleCapture,\n          className: \"btn-capture\",\n          disabled: !stream || error,\n          children: \"Take Photo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onClose,\n          className: \"btn-cancel\",\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 5\n  }, this);\n};\n_s(CameraCaptureModal, \"PrOmCr2NftPMQzhpBwj2ettfnus=\");\n_c = CameraCaptureModal;\nexport default CameraCaptureModal;\nvar _c;\n$RefreshReg$(_c, \"CameraCaptureModal\");","map":{"version":3,"names":["React","useRef","useEffect","useState","jsxDEV","_jsxDEV","CameraCaptureModal","isOpen","onClose","onCapture","_s","videoRef","canvasRef","stream","setStream","error","setError","startCamera","stopCamera","navigator","mediaDevices","getUserMedia","video","current","srcObject","err","console","getTracks","forEach","track","stop","handleCapture","canvas","width","videoWidth","height","videoHeight","context","getContext","translate","scale","drawImage","imageDataUrl","toDataURL","className","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","autoPlay","playsInline","style","display","onClick","disabled","_c","$RefreshReg$"],"sources":["C:/Users/Tshepiso Selemela/OneDrive/Documents/Tymstamp/FrontEnd/my-app/src/components/CameraCaptureModal.js"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\r\nimport '../styles/FacialRecognition.css'; // Reusing styles for a consistent look\r\n\r\n/**\r\n * A generic modal component for capturing a photo using the device's camera.\r\n * @param {object} props\r\n * @param {boolean} props.isOpen - Controls if the modal is visible.\r\n * @param {function} props.onClose - Function to call when the modal is closed.\r\n * @param {function} props.onCapture - Function to call with the captured image data (base64).\r\n */\r\nconst CameraCaptureModal = ({ isOpen, onClose, onCapture }) => {\r\n  const videoRef = useRef(null);\r\n  const canvasRef = useRef(null);\r\n  const [stream, setStream] = useState(null);\r\n  const [error, setError] = useState('');\r\n\r\n  // Effect to start and stop the camera stream based on modal visibility.\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      startCamera();\r\n    } else {\r\n      stopCamera();\r\n    }\r\n\r\n    // Cleanup function to ensure the camera is turned off when the component unmounts.\r\n    return () => {\r\n      stopCamera();\r\n    };\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [isOpen]);\r\n\r\n  /**\r\n   * Requests camera access and starts the video stream.\r\n   */\r\n  const startCamera = async () => {\r\n    setError('');\r\n    // Ensure we can access the user's camera.\r\n    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\r\n        setError('Camera is not supported by this browser.');\r\n        return;\r\n    }\r\n\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({ video: true });\r\n      setStream(stream);\r\n      if (videoRef.current) {\r\n        videoRef.current.srcObject = stream;\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error accessing camera:\", err);\r\n      setError('Could not access the camera. Please ensure you have given permission in your browser settings.');\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Stops all tracks of the active camera stream.\r\n   */\r\n  const stopCamera = () => {\r\n    if (stream) {\r\n      stream.getTracks().forEach(track => track.stop());\r\n      setStream(null);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Captures a still frame from the video feed and passes it to the parent.\r\n   */\r\n  const handleCapture = () => {\r\n    if (videoRef.current && canvasRef.current) {\r\n      const video = videoRef.current;\r\n      const canvas = canvasRef.current;\r\n      \r\n      canvas.width = video.videoWidth;\r\n      canvas.height = video.videoHeight;\r\n\r\n      const context = canvas.getContext('2d');\r\n      // Flip the image horizontally to match the mirrored video feed\r\n      context.translate(video.videoWidth, 0);\r\n      context.scale(-1, 1);\r\n      context.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);\r\n      \r\n      // Convert the canvas image to a base64 data URL (JPEG format).\r\n      const imageDataUrl = canvas.toDataURL('image/jpeg');\r\n      \r\n      onCapture(imageDataUrl);\r\n      onClose(); // Close the modal after capture\r\n    }\r\n  };\r\n\r\n  if (!isOpen) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"facial-rec-backdrop\">\r\n      <div className=\"facial-rec-content\">\r\n        <h3>Capture Employee Photo</h3>\r\n        <p>Please ask the employee to face the camera.</p>\r\n        <div className=\"camera-container\">\r\n          {error ? (\r\n            <div className=\"camera-error\">{error}</div>\r\n          ) : (\r\n            <video ref={videoRef} autoPlay playsInline className=\"camera-feed\" />\r\n          )}\r\n          <canvas ref={canvasRef} style={{ display: 'none' }} />\r\n        </div>\r\n        <div className=\"facial-rec-actions\">\r\n          <button onClick={handleCapture} className=\"btn-capture\" disabled={!stream || error}>\r\n            Take Photo\r\n          </button>\r\n          <button onClick={onClose} className=\"btn-cancel\">\r\n            Cancel\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CameraCaptureModal;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,MAAM,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC1D,OAAO,iCAAiC,CAAC,CAAC;;AAE1C;AACA;AACA;AACA;AACA;AACA;AACA;AANA,SAAAC,MAAA,IAAAC,OAAA;AAOA,MAAMC,kBAAkB,GAAGA,CAAC;EAAEC,MAAM;EAAEC,OAAO;EAAEC;AAAU,CAAC,KAAK;EAAAC,EAAA;EAC7D,MAAMC,QAAQ,GAAGV,MAAM,CAAC,IAAI,CAAC;EAC7B,MAAMW,SAAS,GAAGX,MAAM,CAAC,IAAI,CAAC;EAC9B,MAAM,CAACY,MAAM,EAAEC,SAAS,CAAC,GAAGX,QAAQ,CAAC,IAAI,CAAC;EAC1C,MAAM,CAACY,KAAK,EAAEC,QAAQ,CAAC,GAAGb,QAAQ,CAAC,EAAE,CAAC;;EAEtC;EACAD,SAAS,CAAC,MAAM;IACd,IAAIK,MAAM,EAAE;MACVU,WAAW,CAAC,CAAC;IACf,CAAC,MAAM;MACLC,UAAU,CAAC,CAAC;IACd;;IAEA;IACA,OAAO,MAAM;MACXA,UAAU,CAAC,CAAC;IACd,CAAC;IACH;EACA,CAAC,EAAE,CAACX,MAAM,CAAC,CAAC;;EAEZ;AACF;AACA;EACE,MAAMU,WAAW,GAAG,MAAAA,CAAA,KAAY;IAC9BD,QAAQ,CAAC,EAAE,CAAC;IACZ;IACA,IAAI,CAACG,SAAS,CAACC,YAAY,IAAI,CAACD,SAAS,CAACC,YAAY,CAACC,YAAY,EAAE;MACjEL,QAAQ,CAAC,0CAA0C,CAAC;MACpD;IACJ;IAEA,IAAI;MACF,MAAMH,MAAM,GAAG,MAAMM,SAAS,CAACC,YAAY,CAACC,YAAY,CAAC;QAAEC,KAAK,EAAE;MAAK,CAAC,CAAC;MACzER,SAAS,CAACD,MAAM,CAAC;MACjB,IAAIF,QAAQ,CAACY,OAAO,EAAE;QACpBZ,QAAQ,CAACY,OAAO,CAACC,SAAS,GAAGX,MAAM;MACrC;IACF,CAAC,CAAC,OAAOY,GAAG,EAAE;MACZC,OAAO,CAACX,KAAK,CAAC,yBAAyB,EAAEU,GAAG,CAAC;MAC7CT,QAAQ,CAAC,gGAAgG,CAAC;IAC5G;EACF,CAAC;;EAED;AACF;AACA;EACE,MAAME,UAAU,GAAGA,CAAA,KAAM;IACvB,IAAIL,MAAM,EAAE;MACVA,MAAM,CAACc,SAAS,CAAC,CAAC,CAACC,OAAO,CAACC,KAAK,IAAIA,KAAK,CAACC,IAAI,CAAC,CAAC,CAAC;MACjDhB,SAAS,CAAC,IAAI,CAAC;IACjB;EACF,CAAC;;EAED;AACF;AACA;EACE,MAAMiB,aAAa,GAAGA,CAAA,KAAM;IAC1B,IAAIpB,QAAQ,CAACY,OAAO,IAAIX,SAAS,CAACW,OAAO,EAAE;MACzC,MAAMD,KAAK,GAAGX,QAAQ,CAACY,OAAO;MAC9B,MAAMS,MAAM,GAAGpB,SAAS,CAACW,OAAO;MAEhCS,MAAM,CAACC,KAAK,GAAGX,KAAK,CAACY,UAAU;MAC/BF,MAAM,CAACG,MAAM,GAAGb,KAAK,CAACc,WAAW;MAEjC,MAAMC,OAAO,GAAGL,MAAM,CAACM,UAAU,CAAC,IAAI,CAAC;MACvC;MACAD,OAAO,CAACE,SAAS,CAACjB,KAAK,CAACY,UAAU,EAAE,CAAC,CAAC;MACtCG,OAAO,CAACG,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;MACpBH,OAAO,CAACI,SAAS,CAACnB,KAAK,EAAE,CAAC,EAAE,CAAC,EAAEA,KAAK,CAACY,UAAU,EAAEZ,KAAK,CAACc,WAAW,CAAC;;MAEnE;MACA,MAAMM,YAAY,GAAGV,MAAM,CAACW,SAAS,CAAC,YAAY,CAAC;MAEnDlC,SAAS,CAACiC,YAAY,CAAC;MACvBlC,OAAO,CAAC,CAAC,CAAC,CAAC;IACb;EACF,CAAC;EAED,IAAI,CAACD,MAAM,EAAE;IACX,OAAO,IAAI;EACb;EAEA,oBACEF,OAAA;IAAKuC,SAAS,EAAC,qBAAqB;IAAAC,QAAA,eAClCxC,OAAA;MAAKuC,SAAS,EAAC,oBAAoB;MAAAC,QAAA,gBACjCxC,OAAA;QAAAwC,QAAA,EAAI;MAAsB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC/B5C,OAAA;QAAAwC,QAAA,EAAG;MAA2C;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,eAClD5C,OAAA;QAAKuC,SAAS,EAAC,kBAAkB;QAAAC,QAAA,GAC9B9B,KAAK,gBACJV,OAAA;UAAKuC,SAAS,EAAC,cAAc;UAAAC,QAAA,EAAE9B;QAAK;UAAA+B,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,gBAE3C5C,OAAA;UAAO6C,GAAG,EAAEvC,QAAS;UAACwC,QAAQ;UAACC,WAAW;UAACR,SAAS,EAAC;QAAa;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CACrE,eACD5C,OAAA;UAAQ6C,GAAG,EAAEtC,SAAU;UAACyC,KAAK,EAAE;YAAEC,OAAO,EAAE;UAAO;QAAE;UAAAR,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACnD,CAAC,eACN5C,OAAA;QAAKuC,SAAS,EAAC,oBAAoB;QAAAC,QAAA,gBACjCxC,OAAA;UAAQkD,OAAO,EAAExB,aAAc;UAACa,SAAS,EAAC,aAAa;UAACY,QAAQ,EAAE,CAAC3C,MAAM,IAAIE,KAAM;UAAA8B,QAAA,EAAC;QAEpF;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACT5C,OAAA;UAAQkD,OAAO,EAAE/C,OAAQ;UAACoC,SAAS,EAAC,YAAY;UAAAC,QAAA,EAAC;QAEjD;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV,CAAC;AAACvC,EAAA,CA3GIJ,kBAAkB;AAAAmD,EAAA,GAAlBnD,kBAAkB;AA6GxB,eAAeA,kBAAkB;AAAC,IAAAmD,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}